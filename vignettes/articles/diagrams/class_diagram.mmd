
classDiagram

  class anndataR {
    AnnData()
    read_h5ad(path, backend)
    as_AnnData(obj)
  }

  class InMemoryAnnData {
    init(X, obs, var, shape, ...)
  }

  class HDF5AnnData {
    init(h5file)
  }

  class ReticulateAnnData["ReticulateAnnData"] {
    init(ptr)
  }

  class ZarrAnnData["ZarrAnnData (Planned)"] {
    init(zarrFile)
  }
  style ZarrAnnData fill:#bbf,stroke-width:2px,color:#fff,stroke-dasharray: 5 5

  anndataR --> InMemoryAnnData
  anndataR --> HDF5AnnData
  anndataR --> ZarrAnnData
  anndataR --> ReticulateAnnData

  HDF5AnnData --|> AbstractAnnData
  InMemoryAnnData --|> AbstractAnnData
  ReticulateAnnData --|> AbstractAnnData
  ZarrAnnData --|> AbstractAnnData
  AnnDataView --|> AbstractAnnData

  class AbstractAnnData {
    *X: Matrix | SparseMatrix
    *layers: List[Matrix | SparseMatrix]
    *obs: DataFrame
    *var: DataFrame
    *obsp: List[Matrix | SparseMatrix | DataFrame]
    *varp: List[Matrix | SparseMatrix | DataFrame]
    *obsm: List[Matrix | SparseMatrix | DataFrame]
    *varm: List[Matrix | SparseMatrix | DataFrame]
    *uns: List

    n_obs: int
    n_vars: int
    shape: Array[int]
    obs_names: Array[String]
    var_names: Array[String]
    obs_keys: Array[String]
    var_keys: Array[String]
    layers_keys: Array[String]
    obsm_keys: Array[String]
    obsp_keys: Array[String]
    varp_keys: Array[String]
    uns_keys: Array[String]

    write_h5ad(): Unit

    as_SingleCellExperiment(): SingleCellExperiment
    as_Seurat(): Seurat

    as_HDF5AnnData(): HDF5AnnData
    as_InMemoryAnnData(): InMemoryAnnData
    as_ReticulateAnnData(): ReticulateAnnData

    .[,]: AnnDataView
  }

  AbstractAnnData --> SingleCellExperiment
  AbstractAnnData --> Seurat
  AbstractAnnData --> AnnDataView

  class AnnDataView {
    init(ad)
    subset(ad, i, j)
  }
