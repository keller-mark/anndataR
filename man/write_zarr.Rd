% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/write_zarr.R
\name{write_zarr}
\alias{write_zarr}
\title{Write Zarr}
\usage{
write_zarr(
  object,
  store,
  compression = c("none", "gzip", "lzf"),
  mode = c("w-", "r", "r+", "a", "w", "x")
)
}
\arguments{
\item{object}{The object to write, either a "SingleCellExperiment" or a
"Seurat" object}

\item{compression}{The compression algorithm to use when writing the
HDF5 file. Can be one of \code{"none"}, \code{"gzip"} or \code{"lzf"}. Defaults to
\code{"none"}.}

\item{mode}{The mode to open the HDF5 file.
\itemize{
\item \code{a} creates a new file or opens an existing one for read/write.
\item \verb{r+} opens an existing file for read/write.
\item \code{w} creates a file, truncating any existing ones
\item \verb{w-}/\code{x} are synonyms creating a file and failing if it already exists.
}}

\item{path}{Path of the file to write to}
}
\value{
\code{path} invisibly
}
\description{
Write a Zarr store
}
\examples{
adata <- AnnData(
  X = matrix(1:15, 3L, 5L),
  layers = list(
    A = matrix(15:1, 3L, 5L),
    B = matrix(letters[1:15], 3L, 5L)
  ),
  obs = data.frame(cell = 1:3),
  var = data.frame(gene = 1:5),
  obs_names = LETTERS[1:3],
  var_names = letters[1:5]
)
h5ad_file <- tempfile(fileext = ".h5ad")
write_zarr(adata, h5ad_file)

# Write a SingleCellExperiment as an H5AD
if (requireNamespace("SingleCellExperiment", quietly = TRUE)) {
  ncells <- 100
  counts <- matrix(rpois(20000, 5), ncol = ncells)
  logcounts <- log2(counts + 1)

  pca <- matrix(runif(ncells * 5), ncells)
  tsne <- matrix(rnorm(ncells * 2), ncells)

  sce <- SingleCellExperiment::SingleCellExperiment(
    assays = list(counts = counts, logcounts = logcounts),
    reducedDims = list(PCA = pca, tSNE = tsne)
  )

  h5ad_file <- tempfile(fileext = ".h5ad")
  write_zarr(sce, h5ad_file)
}

# Write a Seurat as a H5AD
if (requireNamespace("SeuratObject", quietly = TRUE)) {
  # TODO: uncomment this code when the seurat converter is fixed
  # counts <- matrix(1:15, 3L, 5L)
  # dimnames(counts) <- list(
  #   letters[1:3],
  #   LETTERS[1:5]
  # )
  # gene.metadata <- data.frame(
  #   row.names = LETTERS[1:5],
  #   gene = 1:5
  # )
  # obj <- SeuratObject::CreateSeuratObject(counts, meta.data = gene.metadata)
  # cell.metadata <- data.frame(
  #   row.names = letters[1:3],
  #   cell = 1:3
  # )
  # obj <- SeuratObject::AddMetaData(obj, cell.metadata)
  #
  # h5ad_file <- tempfile(fileext = ".h5ad")
  # write_zarr(obj, h5ad_file)
}
}
